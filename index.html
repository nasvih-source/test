<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArabDreams AI Assistant</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
     <style>
       * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold: #C9A961;
            --gold-dark: #B08D4F;
            --gold-light: #E8D9B0;
            --black: #1A1A1A;
            --gray-dark: #3A3A3A;
            --gray: #777777;
            --gray-light: #F0F0F0;
            --white: #FFFFFF;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
            background: #f8f8f8;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: 1020px;
            height: 90vh;
            background: var(--white);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .header {
            background: var(--white);
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .header-info h1 {
            font-size: 16px;
            font-weight: 600;
            color: var(--black);
            letter-spacing: -0.3px;
            margin-bottom: 2px;
        }

        .header-info p {
            font-size: 12px;
            color: var(--gray);
            font-weight: 400;
        }

        .status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: rgba(201, 169, 97, 0.08);
            border-radius: 10px;
            border: 1px solid rgba(201, 169, 97, 0.2);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--gold);
            border-radius: 50%;
        }

        .status-text {
            font-size: 11px;
            color: var(--gold);
            font-weight: 500;
        }

        .messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            background: #FAFAFA;
        }

        .msg {
            display: flex;
            animation: slide 0.3s ease;
        }

        @keyframes slide {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .msg.user {
            justify-content: flex-end;
        }

        .bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.5;
            letter-spacing: -0.1px;
        }

        .msg.bot .bubble {
            background: var(--white);
            color: var(--black);
            border: 1px solid var(--gray-light);
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }

        .msg.user .bubble {
            background: var(--gold);
            color: var(--white);
        }

        .bubble strong {
            font-weight: 600;
            color: var(--gold-dark);
        }

        .msg.user .bubble strong {
            color: var(--white);
        }

        .bubble ul {
            margin: 8px 0;
            padding-left: 0;
            list-style: none;
        }

        .bubble li {
            margin: 4px 0;
            padding-left: 16px;
            position: relative;
        }

        .bubble li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--gold);
            font-size: 14px;
            top: 0;
        }

        .bubble ol {
            margin: 8px 0;
            padding-left: 18px;
        }

        .bubble ol li {
            margin: 4px 0;
            padding-left: 6px;
        }

        .bubble ol li::before {
            content: none;
        }

        .typing {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--white);
            border: 1px solid var(--gray-light);
            border-radius: 18px;
            max-width: 70px;
        }

        .dot {
            width: 6px;
            height: 6px;
            background: var(--gold);
            border-radius: 50%;
            animation: bounce 1.4s infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-6px); opacity: 1; }
        }

        .welcome {
            background: var(--white);
            border: 1px solid var(--gray-light);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 8px;
        }

        .welcome h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--black);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .welcome-icon {
            width: 18px;
            height: 18px;
            background: var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: var(--white);
        }

        .welcome p {
            font-size: 13px;
            color: var(--gray);
            line-height: 1.5;
        }

        .welcome strong {
            color: var(--gold-dark);
            font-weight: 600;
        }

        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .chip {
            background: var(--white);
            border: 1px solid var(--gold);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            color: var(--black);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .chip:hover {
            background: var(--gold);
            color: var(--white);
        }

        .input-area {
            padding: 16px 20px 20px;
            background: var(--white);
            border-top: 1px solid var(--gray-light);
        }

        .input-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #FAFAFA;
            border: 1px solid var(--gray-light);
            border-radius: 20px;
            padding: 4px 4px 4px 16px;
            transition: all 0.2s ease;
        }

        .input-box:focus-within {
            border-color: var(--gold);
            background: var(--white);
        }

        .input-box input {
            flex: 1;
            border: none;
            background: none;
            outline: none;
            font-size: 14px;
            color: var(--black);
            font-family: inherit;
            padding: 10px 0;
        }

        .input-box input::placeholder {
            color: var(--gray);
        }

        .send-btn {
            width: 32px;
            height: 32px;
            background: var(--gold);
            border: none;
            border-radius: 50%;
            color: var(--white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-btn:hover:not(:disabled) {
            background: var(--gold-dark);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        .send-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .messages::-webkit-scrollbar {
            width: 4px;
        }

        .messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .messages::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 2px;
        }

        .messages::-webkit-scrollbar-thumb:hover {
            background: var(--gold-dark);
        }

       @media (max-width: 500px) {
    .container {
        height: 100vh;
        max-width: 100%;
        border-radius: 0;
        width: 100%;
    }
    
    body {
        padding: 0;
        margin: 0;
        overflow: hidden;
    }
    
    .messages {
        padding: 16px;
        margin-bottom: 0;
        position: relative;
        height: calc(100vh - 120px); /* Adjust based on header and input height */
        overflow-y: auto;
        margin-top: 60px; /* Space for fixed header */
    }
    
    .header {
        margin-top: 0;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        width: 100%;
        z-index: 1000;
        background: white; /* Or your preferred background color */
    }
    
    /* Add this for the input area if you have one */
    .input-area {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        background: white;
        padding: 10px;
        border-top: 1px solid #ccc;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="logo">
                    <img src="logo.png" alt="ArabDreams Logo">
                </div>
                <div class="header-info">
                    <h1>ARAB DREAMS</h1>
                    <p>Business Consultancy</p>
                </div>
            </div>
            <div class="status">
                <div class="status-dot"></div>
                <span class="status-text">AI Online</span>
            </div>
        </div>

        <div class="messages" id="msgs">
            <div class="msg bot">
                <div>
                    <div class="welcome">
                        <h3>
                            <span class="welcome-icon">AD</span>
                            Welcome to ArabDreams
                        </h3>
                        <p>Your premier partner for business success in Saudi Arabia. We specialize in helping international and local businesses establish with <strong>100% foreign ownership</strong> options.</p>
                    </div>
                    <div class="bubble">
                        How can I assist you with your Saudi Arabian business goals today?
                    </div>
                    <div class="chips">
                        <div class="chip" onclick="send('What services do you offer?')">Our Services</div>
                        <div class="chip" onclick="send('Business setup process?')">Setup Process</div>
                        <div class="chip" onclick="send('Tell me about visas')">Visa Services</div>
                        <div class="chip" onclick="send('Why Saudi Arabia?')">Why KSA</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="input-box">
                <input 
                    type="text" 
                    id="input" 
                    placeholder="Type your message here..."
                    maxlength="500"
                >
                <button class="send-btn" id="btn">
                    <i class="fas fa-arrow-up"></i>
                </button>
            </div>
        </div>
    </div>

    


  <script>
    // Storage key for chat history
    const STORAGE_KEY = 'arabdreams_chat_history';
    
    // Conversation history
    let conversationHistory = [];

    const msgs = document.getElementById('msgs');
    const input = document.getElementById('input');
    const btn = document.getElementById('btn');

    // Contact info by language
    const CONTACTS = {
        en: `\n\n📞 **Contact Our Consultants for Pricing & Personalized Service:**\n+966 53 352 6262 | +966 53 514 6644\n📍 **Global Offices:** KSA, UAE, UK, India, China\n\n⚠️ *AI-Generated Response: For accurate pricing and detailed consultation, please contact our experts directly.*`,
        ar: `\n\n📞 **اتصل بمستشارينا للأسعار والخدمة الشخصية:**\n‎+966 53 352 6262 | +966 53 514 6644\n📍 **مكاتب عالمية:** السعودية، الإمارات، المملكة المتحدة، الهند، الصين\n\n⚠️ *استجابة AI: للحصول على أسعار دقيقة واستشارة مفصلة، يرجى الاتصال بخبرائنا مباشرة.*`,
        ur: `\n\n📞 **قیمتوں اور ذاتی خدمات کے لیے ہمارے مشیران سے رابطہ کریں:**\n‎+966 53 352 6262 | +966 53 514 6644\n📍 **عالمی دفاتر:** سعودی عرب، متحدہ عرب امارات، برطانیہ، ہندوستان، چین\n\n⚠️ *AI جواب: درست قیمتوں اور تفصیلی مشاورت کے لیے براہ کرم ہمارے ماہرین سے براہ راست رابطہ کریں۔*`,
        ml: `\n\n📞 **വിലനിർണ്ണയത്തിനും വ്യക്തിഗത സേവനത്തിനും ഞങ്ങളുടെ കൺസൾട്ടന്റുമാരെ ബന്ധപ്പെടുക:**\n+966 53 352 6262 | +966 53 514 6644\n📍 **ആഗോള ഓഫീസുകൾ:** സൗദി, UAE, UK, ഇന്ത്യ, ചൈന\n\n⚠️ *AI പ്രതികരണം: കൃത്യമായ വിലനിർണ്ണയത്തിനും വിശദമായ കൺസൾട്ടേഷനുമായി ദയവായി ഞങ്ങളുടെ വിദഗ്ധരെ നേരിട്ട് ബന്ധപ്പെടുക.*`
    };

    // Language detection
    function detectLanguage(text) {
        const malayalam = /[\u0D00-\u0D7F]/;
        const arabic = /[\u0600-\u06FF\u0750-\u077F]/;
        
        if (malayalam.test(text)) return 'ml';
        if (arabic.test(text)) {
            if (text.includes('ہے') || text.includes('ہیں') || text.includes('کیا')) return 'ur';
            return 'ar';
        }
        return 'en';
    }

    function format(text) {
        text = text.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
        text = text.replace(/^[•\-\*]\s+(.+)$/gm, '<li>$1</li>');
        text = text.replace(/(<li>.*?<\/li>\n?)+/g, '<ul>$&</ul>');
        text = text.replace(/^(\d+)\.\s+(.+)$/gm, '<li>$2</li>');
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = text;
        const lists = tempDiv.querySelectorAll('ul');
        lists.forEach(ul => {
            if (ul.previousElementSibling?.tagName === 'UL') return;
            const firstLi = ul.querySelector('li');
            if (firstLi && /^\d+/.test(firstLi.textContent.trim())) {
                const ol = document.createElement('ol');
                ol.innerHTML = ul.innerHTML;
                ul.replaceWith(ol);
            }
        });
        text = tempDiv.innerHTML;
        text = text.replace(/\n\n/g, '<br><br>');
        text = text.replace(/\n/g, '<br>');
        return text;
    }

    function add(text, type) {
        const div = document.createElement('div');
        div.className = `msg ${type}`;
        
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        
        if (type === 'bot') {
            bubble.innerHTML = format(text);
        } else {
            bubble.textContent = text;
        }
        
        div.appendChild(bubble);
        msgs.appendChild(div);
        msgs.scrollTop = msgs.scrollHeight;

        // Save to history
        if (type === 'user' || type === 'bot') {
            saveToHistory(text, type);
        }
    }

    function typing(show) {
        const existing = document.getElementById('typing');
        if (existing) existing.remove();
        
        if (show) {
            const div = document.createElement('div');
            div.className = 'msg bot';
            div.id = 'typing';
            div.innerHTML = '<div class="typing"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';
            msgs.appendChild(div);
            msgs.scrollTop = msgs.scrollHeight;
        }
    }

    // Save chat to localStorage
    function saveToHistory(message, type) {
        conversationHistory.push({ message, type, timestamp: Date.now() });
        if (conversationHistory.length > 50) {
            conversationHistory = conversationHistory.slice(-50);
        }
        localStorage.setItem(STORAGE_KEY, JSON.stringify(conversationHistory));
    }

    // Load chat history
    function loadHistory() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
            try {
                conversationHistory = JSON.parse(saved);
            } catch (e) {
                console.error('Error loading history:', e);
            }
        }
    }

    // Enhanced response templates
    const RESPONSE_TEMPLATES = {
        en: {
            welcome: `🏢 **Welcome to ArabDreams - Your Premier Business Partner in Saudi Arabia!**

**About Us:**
• 10+ Years of Experience | 100+ Professionals | 3000+ Satisfied Clients
• ISO Certified | International Accreditation

**Core Services:**
• Business Setup & Company Formation (100% Foreign Ownership)
• All Business Licenses & Regulatory Compliance
• PRO & Visa Services
• Accounting, Tax & Audit Solutions
• Market Entry Advisory & Corporate Legal Assistance

**Vision 2030 Opportunities:**
• NEOM, THE LINE, OXAGON, TROJENA Mega Projects
• Economic diversification & simplified regulations
• Strategic gateway to Asia, Africa, and Europe

**📍 Our Offices:** Jeddah, Riyadh, Dammam, Buraidah, Dubai, UK, India, China`,

            pricing: `💼 **Business Setup Investment**

We provide customized pricing based on your specific business requirements. Our consultants will analyze:

• Your business activity and license type
• Office space requirements
• Number of visas needed
• Specific regulatory compliance needs

**📞 Contact our consultants for detailed, accurate pricing tailored to your business:**`,

            services: `🛠️ **Our Comprehensive Services**

**Business Setup:**
• Company formation with 100% foreign ownership
• All types of business licenses
• Complete documentation support

**Business Support:**
• PRO & GRO services
• Visa and immigration processing
• Government liaison services

**Financial Services:**
• Accounting & bookkeeping
• Tax compliance & VAT registration
• Audit & financial reporting

**Advisory Services:**
• Market entry strategy
• Legal & compliance advisory
• Business restructuring`,

            contact: `📞 **Global Contact Network**

**Saudi Arabia:**
Jeddah: +966 53 514 6644
Riyadh: +966 53 773 7800
Dammam: +966 53 352 3131
Buraidah: +966 55 019 2663

**International:**
UAE: +971 58 289 9477
UK: +44 791 774 8010
India: +91 99955 76333

📧 **Email:** info@arabdreams.com`
        },
        ar: {
            welcome: `🏢 **مرحباً بكم في ArabDreams - شريككم الأول للأعمال في السعودية!**

**معلومات عنا:**
• 10+ سنوات خبرة | 100+ محترف | 3000+ عميل راضي
• معتمد بالأيزو | اعتماد دولي

**خدماتنا الأساسية:**
• تأسيس الأعمال وتكوين الشركات (ملكية أجنبية 100٪)
• جميع التراخيص التجارية والامتثال التنظيمي
• خدمات PRO والتأشيرات
• الحلول المحاسبية والضريبية والتدقيق
• الاستشارات الإستراتيجية والدعم القانوني`,

            pricing: `💼 **استثمار تأسيس الأعمال**

نوفر أسعاراً مخصصة بناءً على متطلبات عملك المحددة. سيحلل مستشارونا:

• نشاط عملك ونوع الترخيص
• متطلبات مساحة المكتب
• عدد التأشيرات المطلوبة
• احتياجات الامتثال التنظيمي الخاصة

**📞 اتصل بمستشارينا للحصول على أسعار مفصلة ودقيقة مخصصة لعملك:**`,

            services: `🛠️ **خدماتنا الشاملة**

**تأسيس الأعمال:**
• تكوين الشركات بملكية أجنبية 100٪
• جميع أنواع التراخيص التجارية
• دعم الوثائق الكامل

**دعم الأعمال:**
• خدمات PRO وGRO
• معالجة التأشيرات والهجرة
• خدمات الاتصال الحكومي`,

            contact: `📞 **شبكة الاتصال العالمية**

**السعودية:**
جدة: +966 53 514 6644
الرياض: +966 53 773 7800
الدمام: +966 53 352 3131
بريدة: +966 55 019 2663

**الدولية:**
الإمارات: +971 58 289 9477
بريطانيا: +44 791 774 8010
الهند: +91 99955 76333

📧 **البريد:** info@arabdreams.com`
        },
        ur: {
            welcome: `🏢 **ArabDreams میں خوش آمدید - سعودی عرب میں آپ کا اولین کاروباری پارٹنر!**

**ہمارے بارے میں:**
• 10+ سال کا تجربہ | 100+ پیشہ ور | 3000+ مطمئن کلائنٹ
• ISO Certified | بین الاقوامی accredition

**بنیادی خدمات:**
• کاروبار کا قیام اور کمپنی کی تشکیل (100% غیر ملکی ملکیت)
• تمام کاروباری لائسنسز اور ریگولیٹری کمپلائنس
• PRO اور ویزا سروسز
• اکاؤنٹنگ، ٹیکس اور آڈٹ سولیوشنز`,

            pricing: `💼 **کاروبار قائم کرنے میں سرمایہ کاری**

ہم آپ کی مخصوص کاروباری ضروریات کی بنیاد پر حسب ضرورت قیمتیں فراہم کرتے ہیں۔ ہمارے مشیران تجزیہ کریں گے:

• آپ کی کاروباری سرگرمی اور لائسنس کی قسم
• دفتر کی جگہ کی ضروریات
• درکار ویزا کی تعداد
• مخصوص ریگولیٹری کمپلائنس ضروریات

**📞 اپنے کاروبار کے لیے حسب ضرورت تفصیلی، درست قیمتوں کے لیے ہمارے مشیران سے رابطہ کریں:**`,

            services: `🛠️ **ہماری جامع خدمات**

**کاروبار کا قیام:**
• 100% غیر ملکی ملکیت کے ساتھ کمپنی کی تشکیل
• کاروباری لائسنس کی تمام اقسام
• دستاویزات کی مکمل سپورٹ`,

            contact: `📞 **گلوبل رابطہ نیٹ ورک**

**سعودی عرب:**
جدہ: +966 53 514 6644
ریاض: +966 53 773 7800
دمام: +966 53 352 3131
بوریدہ: +966 55 019 2663

**بین الاقوامی:**
متحدہ عرب امارات: +971 58 289 9477
برطانیہ: +44 791 774 8010
ہندوستان: +91 99955 76333

📧 **ای میل:** info@arabdreams.com`
        },
        ml: {
            welcome: `🏢 **ArabDreams-ലേക്ക് സ്വാഗതം - സൗദി അറേബിയയിലെ നിങ്ങളുടെ പ്രമുഖ ബിസിനസ്സ് പങ്കാളി!**

**ഞങ്ങളെക്കുറിച്ച്:**
• 10+ വർഷം പരിചയം | 100+ പ്രൊഫഷണലുകൾ | 3000+ തൃപ്തരായ ക്ലയന്റുകൾ
• ISO Certified | അന്തർദേശീയ അംഗീകാരം

**മുഖ്യ സേവനങ്ങൾ:**
• ബിസിനസ്സ് സജ്ജീകരണവും കമ്പനി രൂപീകരണവും (100% വിദേശ ഉടമസ്ഥത)
• എല്ലാ ബിസിനസ്സ് ലൈസൻസുകളും നിയന്ത്രണ അനുസൃതത
• PRO, വിസ സേവനങ്ങൾ
• അക്കൗണ്ടിംഗ്, നികുതി, ഓഡിറ്റ് പരിഹാരങ്ങൾ`,

            pricing: `💼 **ബിസിനസ്സ് സജ്ജീകരണ നിക്ഷേപം**

നിങ്ങളുടെ നിർദ്ദിഷ്ട ബിസിനസ്സ് ആവശ്യങ്ങളെ അടിസ്ഥാനമാക്കി ഞങ്ങൾ ഇഷ്ടാനുസൃത വിലനിർദ്ദേശം നൽകുന്നു. ഞങ്ങളുടെ കൺസൾട്ടന്റുമാർ വിശകലനം ചെയ്യും:

• നിങ്ങളുടെ ബിസിനസ്സ് പ്രവർത്തനവും ലൈസൻസ് തരവും
• ഓഫീസ് സ്ഥല ആവശ്യങ്ങൾ
• ആവശ്യമായ വിസകളുടെ എണ്ണം
• നിർദ്ദിഷ്ട നിയന്ത്രണ അനുസൃത ആവശ്യങ്ങൾ

**📞 നിങ്ങളുടെ ബിസിനസ്സിനായി ഇഷ്ടാനുസൃതമായ വിശദമായ, കൃത്യമായ വിലനിർണ്ണയത്തിന് ഞങ്ങളുടെ കൺസൾട്ടന്റുമാരെ ബന്ധപ്പെടുക:**`,

            services: `🛠️ **ഞങ്ങളുടെ സമഗ്ര സേവനങ്ങൾ**

**ബിസിനസ്സ് സജ്ജീകരണം:**
• 100% വിദേശ ഉടമസ്ഥതയോടെ കമ്പനി രൂപീകരണം
• എല്ലാ തരത്തിലുള്ള ബിസിനസ്സ് ലൈസൻസുകളും
• സമ്പൂർണ്ണ ഡോക്യുമെന്റേഷൻ സപ്പോർട്ട്`,

            contact: `📞 **ആഗോള കോൺടാക്റ്റ് നെറ്റ്വർക്ക്**

**സൗദി അറേബിയ:**
ജിദ്ദ: +966 53 514 6644
റിയാദ്: +966 53 773 7800
ദമ്മം: +966 53 352 3131
ബുറൈദ: +966 55 019 2663

**അന്തർദേശീയ:**
UAE: +971 58 289 9477
UK: +44 791 774 8010
ഇന്ത്യ: +91 99955 76333

📧 **ഇമെയിൽ:** info@arabdreams.com`
        }
    };

    async function send(text) {
        if (!text) text = input.value.trim();
        if (!text) return;

        input.value = '';
        input.disabled = true;
        btn.disabled = true;

        add(text, 'user');
        typing(true);

        const lang = detectLanguage(text);
        const contactInfo = CONTACTS[lang];
        const templates = RESPONSE_TEMPLATES[lang] || RESPONSE_TEMPLATES.en;

        try {
            // Check for pricing-related queries
            const pricingKeywords = {
                en: ['cost', 'price', 'fee', 'how much', 'investment', 'charges', 'pricing'],
                ar: ['سعر', 'تكلفة', 'ثمن', 'كم', 'رسوم', 'تكاليف'],
                ur: ['قیمت', 'لاگت', 'کم', 'خرچ', 'فیس'],
                ml: ['വില', 'കോസ്റ്റ്', 'പ്രൈസ്', 'എത്ര', 'ചാർജസ്']
            };

            const lowerText = text.toLowerCase();
            const hasPricingQuery = pricingKeywords[lang]?.some(keyword => 
                lowerText.includes(keyword)
            ) || pricingKeywords.en.some(keyword => lowerText.includes(keyword));

            if (hasPricingQuery) {
                setTimeout(() => {
                    typing(false);
                    let reply = templates.pricing + contactInfo;
                    add(reply, 'bot');
                }, 1000);
                return;
            }

            // Check for service queries
            const serviceKeywords = {
                en: ['service', 'what you do', 'offer', 'provide', 'help with'],
                ar: ['خدمة', 'خدمات', 'ماذا تقدم', 'ماذا تفعل'],
                ur: ['سروس', 'خدمت', 'کیا پیشکش', 'کیا کرتے'],
                ml: ['സേവനം', 'സർവീസ്', 'എന്താണ് നൽകുന്നത്', 'എന്താണ് ചെയ്യുന്നത്']
            };

            const hasServiceQuery = serviceKeywords[lang]?.some(keyword => 
                lowerText.includes(keyword)
            ) || serviceKeywords.en.some(keyword => lowerText.includes(keyword));

            if (hasServiceQuery) {
                setTimeout(() => {
                    typing(false);
                    let reply = templates.services + contactInfo;
                    add(reply, 'bot');
                }, 1000);
                return;
            }

            // Check for contact queries
            const contactKeywords = {
                en: ['contact', 'phone', 'number', 'email', 'address', 'office', 'location'],
                ar: ['اتصل', 'هاتف', 'رقم', 'بريد', 'عنوان', 'مكتب'],
                ur: ['رابطہ', 'فون', 'نمبر', 'ای میل', 'پتہ', 'دفتر'],
                ml: ['കോൺടാക്റ്റ്', 'ഫോൺ', 'നമ്പർ', 'ഇമെയിൽ', 'വിലാസം', 'ഓഫീസ്']
            };

            const hasContactQuery = contactKeywords[lang]?.some(keyword => 
                lowerText.includes(keyword)
            ) || contactKeywords.en.some(keyword => lowerText.includes(keyword));

            if (hasContactQuery) {
                setTimeout(() => {
                    typing(false);
                    let reply = templates.contact + contactInfo;
                    add(reply, 'bot');
                }, 1000);
                return;
            }

            // General query - call Netlify function
            const response = await fetch('/.netlify/functions/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    message: text,
                    context: "ArabDreams Business Consultancy - Never reveal pricing. Always direct to contact consultants for pricing. Provide general information about business setup in Saudi Arabia, Vision 2030, services offered, but never specific costs."
                })
            });

            if (!response.ok) {
                throw new Error(`Network error: ${response.status}`);
            }

            const data = await response.json();
            
            setTimeout(() => {
                typing(false);
                let reply = data.choices?.[0]?.message?.content || templates.welcome;
                // Ensure pricing is never mentioned
                if (reply.toLowerCase().includes('price') || reply.toLowerCase().includes('cost') || 
                    reply.toLowerCase().includes('$') || reply.toLowerCase().includes('fee')) {
                    reply = templates.welcome;
                }
                reply += contactInfo;
                add(reply, 'bot');
            }, 1000);

        } catch (err) {
            console.error('Error:', err);
            setTimeout(() => {
                typing(false);
                let reply = templates.welcome + contactInfo;
                add(reply, 'bot');
            }, 1000);
        } finally {
            input.disabled = false;
            btn.disabled = false;
            input.focus();
        }
    }

    // Event listeners
    btn.onclick = () => send();
    input.onkeypress = (e) => {
        if (e.key === 'Enter') send();
    };

    input.oninput = () => {
        btn.style.opacity = input.value.trim() ? '1' : '0.4';
    };

    // Initialize on load
    window.onload = () => {
        loadHistory();
        input.focus();
        btn.style.opacity = '0.4';
        
        // Show welcome message if no history
        if (conversationHistory.length === 0) {
            const lang = 'en'; // Default language
            const templates = RESPONSE_TEMPLATES[lang];
            const contactInfo = CONTACTS[lang];
            setTimeout(() => {
                add(templates.welcome + contactInfo, 'bot');
            }, 500);
        }
    };

    // Global function for chip buttons
    window.send = send;
</script>



